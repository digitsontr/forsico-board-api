const axios = require("axios");
const fs = require("fs");
const path = require("path");

const sendEmail = async ({ to, subject, htmlPath, accessToken }) => {
  try {
    const html = `<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>You've invited to the new board!</title> <style> body { margin: 0; padding: 0; font-family: 'Arial', sans-serif; background-color: #f0f0f0; } table { border-spacing: 0; width: 100%; } td { padding: 0; } .container { max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 15px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); padding: 20px; text-align: center; } .modal-title { font-size: 28px; font-weight: bold; color: #1C3C84; margin-top: 20px; } .description { font-size: 16px; color: #000000; margin-top: 20px; } .verification-button a { display: inline-block; background-color: #A1F679; color: white; border-radius: 20px; padding: 10px 20px; font-size: 16px; font-weight: bold; text-decoration: none; margin-top: 20px; } .lower-description { font-size: 14px; color: #797979; margin-top: 20px; line-height: 1.5; } .shine-container { position: relative; } .right-shine, .left-big-shine, .left-small-shine { position: absolute; } .right-shine { top: -60px; right: -50px; } .left-big-shine { top: 80px; left: -40px; } .left-small-shine { top: 150px; left: -20px; } .logo { margin-top: 30px; } </style> </head> <body> <table> <tr> <td align="center"> <table class="container"> <tr> <td> <div class="modal-title"> You've invited to the new board! </div> </td> </tr> <tr> <td> <div class="shine-container"> <div class="right-shine"> <svg xmlns="http://www.w3.org/2000/svg" width="76" height="77" viewBox="0 0 76 77" fill="none"> <g filter="url(#filter0_d_211_287)"> <path d="M32.4572 72.2158C34.0851 73.3822 36.0307 74.0058 38.024 74C40.0038 74.0062 41.937 73.3915 43.5588 72.2401C45.2285 71.0447 46.4782 69.34 47.126 67.3742L50.1013 58.1046C50.7306 56.1801 51.7933 54.4306 53.2052 52.9948C54.6171 51.559 56.3393 50.4764 58.2355 49.8326L67.5614 46.7671C69.4422 46.0897 71.0704 44.8393 72.2231 43.1871C73.3757 41.5349 73.9964 39.5618 74 37.538C74 35.4613 73.3449 33.439 72.1303 31.7668C70.9157 30.0946 69.2055 28.8602 67.2495 28.2441L58.0995 25.2435C56.2006 24.6046 54.4747 23.5258 53.0586 22.0928C51.6425 20.6597 50.5752 18.9118 49.9413 16.9877L46.902 7.5559C46.2466 5.63092 45.0121 3.96293 43.3724 2.78686C41.7327 1.6108 39.7705 0.985913 37.7621 1.00024C35.7537 1.01457 33.8003 1.66738 32.1772 2.86673C30.554 4.06607 29.3427 5.75151 28.7141 7.68565L25.7227 16.9795C25.1097 18.8789 24.0748 20.6103 22.6979 22.0402C21.3209 23.4702 19.6386 24.5605 17.7805 25.2273L8.45457 28.2928C6.56951 28.9679 4.93692 30.2184 3.78115 31.8725C2.62538 33.5265 2.00317 35.5028 2 37.5299C2.00209 39.5744 2.63911 41.5662 3.82068 43.2228C5.00225 44.8794 6.66833 46.1167 8.58253 46.7589L17.7325 49.7758C19.6387 50.4131 21.3704 51.4961 22.7876 52.9373C24.2048 54.3785 25.2678 56.1375 25.8907 58.0722L28.922 67.504C29.5835 69.4095 30.8135 71.0591 32.4412 72.2239" fill="#36C5F0"/> </g> </svg> </div> <div class="left-big-shine"> <svg xmlns="http://www.w3.org/2000/svg" width="54" height="53" viewBox="0 0 54 53" fill="none"> <g filter="url(#filter0_d_211_285)"> <path d="M23.1509 48.8024C24.2813 49.5853 25.6324 50.0039 27.0167 50C28.3915 50.0042 29.734 49.5916 30.8603 48.8187C32.0198 48.0163 32.8877 46.872 33.3375 45.5526L35.4037 39.3305C35.8407 38.0387 36.5787 36.8644 37.5592 35.9006C38.5396 34.9369 39.7356 34.2102 41.0524 33.778L47.5288 31.7204C48.8349 31.2657 49.9656 30.4264 50.766 29.3174C51.5665 28.2084 51.9975 26.8839 52 25.5255C52 24.1316 51.5451 22.7741 50.7016 21.6517C49.8582 20.5293 48.6705 19.7007 47.3122 19.2872L40.958 17.273C39.6393 16.8442 38.4408 16.1201 37.4574 15.1582C36.4739 14.1963 35.7328 13.023 35.2926 11.7314L33.182 5.40054C32.7268 4.10843 31.8695 2.98882 30.7308 2.1994C29.5922 1.40999 28.2295 0.990544 26.8348 1.00016C25.4401 1.00978 24.0836 1.44797 22.9564 2.25301C21.8291 3.05805 20.9831 4.18553 20.5507 5.47095L18.4905 11.6721C18.0699 12.963 17.3332 14.137 16.3525 15.1007C15.3718 16.0644 14.1752 16.7897 12.8603 17.2216L6.38393 19.2792C5.07805 19.7347 3.94669 20.5739 3.14592 21.6834C2.34515 22.7928 1.91434 24.1166 1.913 25.475C1.9148 26.8537 2.35528 28.1813 3.14557 29.2967C3.93586 30.4121 5.03972 31.2572 6.28377 31.7201L12.6379 33.7343C13.9533 34.1661 15.1484 34.8901 16.1307 35.852C17.113 36.8139 17.8538 37.9882 18.2757 39.2797L20.3863 45.6106C20.8235 46.8917 21.5649 48.0172 22.7047 48.8078" fill="#36C5F0"/> </g> </svg> </div> <div class="left-small-shine"> <svg xmlns="http://www.w3.org/2000/svg" width="28" height="29" viewBox="0 0 28 29" fill="none"> <g filter="url(#filter0_d_211_284)"> <path d="M11.4567 25.5229C12.082 25.9814 12.8215 26.2344 13.583 26.2541C14.3444 26.2737 15.089 26.0583 15.7145 25.6343C16.3736 25.1855 16.8635 24.5529 17.1054 23.8196L18.3301 20.1169C18.5611 19.4396 18.9514 18.8257 19.4625 18.3342C19.9736 17.8426 20.5872 17.4887 21.2492 17.3061L24.8627 16.202C25.5098 16.0036 26.0485 15.5981 26.3925 15.0464C26.7364 14.4947 26.8626 13.8336 26.7505 13.1876C26.6384 12.5417 26.295 11.9447 25.7795 11.4976C25.264 11.0505 24.6056 10.7836 23.9206 10.7394L20.307 10.6173C19.6457 10.5803 19.0082 10.2798 18.5004 9.76538C17.9925 9.25093 17.6526 8.55578 17.5299 7.80396L17.0521 4.85658C16.9293 4.10477 16.6012 3.42399 16.1145 2.89298C15.6277 2.36197 15.0082 2.01072 14.3359 1.88546C13.6637 1.76021 12.9755 1.86824 12.3658 2.19643C11.756 2.52461 11.2613 3.05272 10.947 3.69114L9.72238 7.39381C9.49144 8.07101 9.10096 8.68479 8.58983 9.17636C8.0787 9.66793 7.46457 10.0217 6.80245 10.2043L3.18893 11.3084C2.54186 11.5069 2.00312 11.9124 1.6591 12.464C1.31508 13.0157 1.18887 13.6767 1.30102 14.3227C1.41317 14.9686 1.75663 15.5656 2.27212 16.0128C2.78761 16.4599 3.44606 16.7268 4.13106 16.7711L7.74459 16.8932C8.4059 16.9302 9.04342 17.2307 9.55129 17.7451C10.0592 18.2596 10.3991 18.9547 10.5219 19.7065L10.9997 22.6539C11.1224 23.4057 11.4505 24.0865 11.9373 24.6175C12.4241 25.1485 13.0436 25.4997 13.7158 25.6249" fill="#36C5F0"/> </g> </svg> </div> </div> </td> </tr> <tr> <td> <div class="description"> You can join the new board by clicking the button below! </div> </td> </tr> <tr> <td> <div class="verification-button"> <a href="https://forsico.io/">Join New Board</a> </div> </td> </tr> <tr> <td> <div class="lower-description"> If you have additional questions, feel free to visit our Help Center.<br> This is a service email for verifying your identity. </div> </td> </tr> <tr> <td> <div class="lower-description"> <img src="https://authapi.forsico.io/Src/logo.svg" /> </div> </td> </tr> </table> </td> </tr> </table> </body> </html>`
    const response = await axios.post(
      `https://forsico-email-service-a4eyd2fdgfgvchcd.eastus-01.azurewebsites.net/api/mail/send`,
      {
        to,
        subject,
        html,
      },
      {
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + accessToken,
        },
      }
    );

    return response.data;
  } catch (error) {
    console.error("Error sending email:", error);
    throw error;
  }
};

module.exports = { sendEmail };
